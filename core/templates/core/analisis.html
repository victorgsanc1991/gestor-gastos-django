{% extends "core/base.html" %}

{% block title %}Análisis Avanzado{% endblock %}

{% block extra_styles %}
<style>
    .filter-form {
        background-color: #f8f9fa; padding: 20px; border: 1px solid #dee2e6;
        border-radius: 8px; margin-bottom: 20px; display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 20px; align-items: end;
    }
    .filter-form .form-group { display: flex; flex-direction: column; }
    .filter-form label { font-weight: bold; margin-bottom: 5px; font-size: 14px; }
    .filter-form input, .filter-form select { padding: 8px; font-size: 16px; border: 1px solid #ccc; border-radius: 4px; }
    .filter-form button { padding: 10px; font-size: 16px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; height: 40px; }
    .category-list { max-height: 150px; overflow-y: auto; border: 1px solid #ccc; padding: 10px; border-radius: 4px; }
    .category-list label { display: block; font-weight: normal; }
</style>
{% endblock %}

{% block content %}
    <h1>Análisis Avanzado</h1>

    <form class="filter-form" method="get" action="{% url 'analisis' %}">
        <div class="form-group">
            <label for="fecha_inicio">Desde:</label>
            <input type="date" name="fecha_inicio" id="fecha_inicio">
        </div>
        <div class="form-group">
            <label for="fecha_fin">Hasta:</label>
            <input type="date" name="fecha_fin" id="fecha_fin">
        </div>
        <div class="form-group">
            <label for="tipo_movimiento">Tipo de Movimiento:</label>
            <select name="tipo_movimiento" id="tipo_movimiento">
                <option value="gastos">Solo Gastos</option>
                <option value="ingresos">Solo Ingresos</option>
                <option value="ambos">Ambos</option>
            </select>
        </div>
        <div class="form-group">
            <label for="agrupacion">Agrupar por:</label>
            <select name="agrupacion" id="agrupacion">
                <option value="mes">Mes</option>
                <option value="semana">Semana</option>
                <option value="dia">Día</option>
            </select>
        </div>
        <div class="form-group" style="grid-column: span 2;">
            <label>Categorías:</label>
            <div class="category-list">
                {% for cat in categorias %}
                <label>
                    <input type="checkbox" name="categorias" value="{{ cat.id }}"> {{ cat.nombre }}
                </label>
                {% endfor %}
            </div>
        </div>
        <div class="form-group">
            <button type="submit">Generar Análisis</button>
        </div>
    </form>

    <!-- Aquí irán los gráficos y la tabla de resultados en el futuro -->
    <div id="resultados-analisis">
        <p>Selecciona los filtros y haz clic en "Generar Análisis" para ver los resultados.</p>
    </div>

{% endblock %}